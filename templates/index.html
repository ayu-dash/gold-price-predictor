<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gold Prediction Pro | Obsidian Dashboard</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200"
        rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
    <div class="dashboard-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="logo">
                <span class="gold-text">GOLD</span> FUTURES PRO
            </div>
            <nav>
                <a href="/" class="nav-item active">
                    <span class="material-symbols-outlined">dashboard</span> Dashboard
                </a>
                <a href="/analytics" class="nav-item">
                    <span class="material-symbols-outlined">analytics</span> Analytics
                </a>
                <a href="/charts" class="nav-item">
                    <span class="material-symbols-outlined">show_chart</span> Charts
                </a>
                <a href="/signals" class="nav-item">
                    <span class="material-symbols-outlined">notifications</span> Signals
                </a>
                <a href="/history" class="nav-item">
                    <span class="material-symbols-outlined">history</span> History
                </a>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header>
                <h1>Market Intelligence Dashboard</h1>
                <div class="date-display" id="current_date">--</div>
            </header>

            <div class="grid-container">
                <!-- Hero Card: Current Price -->
                <div class="card hero-card glass">
                    <div class="card-header">Current Price (IDR/Gram)</div>
                    <div class="price-container">
                        <span id="price_idr" class="main-price">Loading...</span>
                        <span id="price_change" class="change-tag">--%</span>
                    </div>
                    <div class="sub-price" id="price_usd">$ -- / Oz</div>
                </div>

                <!-- Signal Card -->
                <div class="card signal-card glass">
                    <div class="card-header">
                        Trading Signal
                        <div id="signal_light" class="status-light"></div>
                    </div>
                    <div id="signal_value" class="signal-value text-gold">--</div>
                    <div id="target_price" class="sub-price" style="margin-top: 5px; font-weight: 600;">Target: --</div>
                    <div class="action-window">Next Window: <span id="action_date">--</span></div>
                </div>



                <!-- Sentiment Card -->
                <div class="card sentiment-card glass">
                    <div class="card-header">Market Tendency</div>
                    <div class="sentiment-bar-container">
                        <div id="sentiment_bar" class="sentiment-bar" style="width: 50%;"></div>
                    </div>
                    <div class="sentiment-labels">
                        <span>Bullish: <span id="bull_ratio" class="text-gold">--%</span></span>
                        <span>Bearish: <span id="bear_ratio" class="text-red">--%</span></span>
                    </div>
                    <div class="sentiment-score" id="sentiment_avg">Score: 0.00</div>
                </div>

                <!-- Spread Radar Card -->
                <div class="card spread-card glass">
                    <div class="card-header">Spread Radar (Spot vs Phys)</div>
                    <div class="spread-container">
                        <div class="spread-item">
                            <span class="label">Physical (Antam):</span>
                            <span id="physical_price" class="value">Rp --</span>
                        </div>
                        <div class="spread-item">
                            <span class="label">Spot (Intl):</span>
                            <span id="spot_price" class="value">Rp --</span>
                        </div>
                        <div class="spread-diff" id="spread_diff">
                            Spread: --%
                        </div>
                    </div>
                </div>

                <div class="card chart-card glass grid-span-2">
                    <div class="card-header">
                        Historical Trend
                        <div class="timeframe-selector">
                            <button class="tf-btn" data-days="30">1M</button>
                            <button class="tf-btn" data-days="90">3M</button>
                            <button class="tf-btn" data-days="180">6M</button>
                            <button class="tf-btn active" data-days="100">ALL</button>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="historyChart"></canvas>
                    </div>
                </div>

                <!-- Watchlist / Factors -->
                <div class="card factors-card glass">
                    <div class="card-header">Key Risk Watchlist</div>
                    <ul class="factors-list">
                        <li><span class="dot gold"></span> <strong>Profit Taking</strong>: High post-rally risk.</li>
                        <li><span class="dot gold"></span> <strong>The Fed</strong>: Inflation policy watch.</li>
                        <li><span class="dot gold"></span> <strong>Geopolitics</strong>: Middle-East/Europe support.
                        </li>
                    </ul>
                </div>

                <!-- Portfolio Tracker Card -->
                <div class="card portfolio-card glass">
                    <div class="card-header">
                        My Portfolio
                        <button id="edit_portfolio" class="icon-btn">
                            <span class="material-symbols-outlined" style="font-size: 1.2rem;">edit</span>
                        </button>
                    </div>
                    <div class="portfolio-stats">
                        <div class="stat-item">
                            <div class="label">Total Value</div>
                            <div id="portfolio_value" class="value">Rp 0</div>
                        </div>
                        <div class="stat-item">
                            <div class="label">P/L (Today)</div>
                            <div id="portfolio_pl" class="value">--</div>
                        </div>
                    </div>
                    <div class="portfolio-details" id="portfolio_details">
                        Holdings: <span id="portfolio_holdings">0</span>g @ <span id="portfolio_avg_price">Rp 0</span>
                    </div>
                </div>

                <!-- Multi-day Forecast -->
                <div class="card forecast-card glass grid-span-full">
                    <div class="card-header">
                        Interactive Forecast
                        <div class="forecast-input">
                            <div class="input-line">
                                <label>Days:</label>
                                <input type="number" id="forecast_days" value="7" min="2" max="100">
                                <button id="run_forecast">Run Forecast</button>
                            </div>
                            <div class="simulation-sliders">
                                <div class="slider-group">
                                    <label>DXY Shift: <span id="v_dxy">0%</span></label>
                                    <input type="range" id="shift_dxy" min="-10" max="10" value="0" step="0.5">
                                </div>
                                <div class="slider-group">
                                    <label>Oil Shift: <span id="v_oil">0%</span></label>
                                    <input type="range" id="shift_oil" min="-10" max="10" value="0" step="0.5">
                                </div>
                                <div class="slider-group">
                                    <label>USD/IDR Shift: <span id="v_idr">0%</span></label>
                                    <input type="range" id="shift_idr" min="-10" max="10" value="0" step="0.5">
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="forecast-table-container">
                        <table class="forecast-table">
                            <thead>
                                <tr>
                                    <th>Day</th>
                                    <th>Date</th>
                                    <th>Min Price</th>
                                    <th>Max Price</th>
                                    <th>Est. Avg (IDR/g)</th>
                                    <th>Est. Change</th>
                                </tr>
                            </thead>
                            <tbody id="forecast_body">
                                <tr>
                                    <td colspan="6" class="text-center">Set days and click run.</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Portfolio Edit Modal -->
    <div id="portfolio_modal" class="overlay">
        <div class="modal-content glass">
            <h2>Manage Portfolio</h2>
            <div class="input-group">
                <label>Total Gold Owned (grams)</label>
                <input type="number" id="input_gold_amount" step="0.01" placeholder="e.g. 10.5">
            </div>
            <div class="input-group">
                <label>Avg. Purchase Price (IDR/g)</label>
                <input type="number" id="input_purchase_price" placeholder="e.g. 1200000">
            </div>
            <div class="modal-actions">
                <button id="cancel_portfolio" class="bg-grey">Cancel</button>
                <button id="save_portfolio">Save Holdings</button>
            </div>
        </div>
    </div>

    <!-- Loading Modal -->
    <div id="loading_overlay" class="overlay">
        <div class="loader-content">
            <div class="spinner"></div>
            <p>Analyzing Global Market Trends...</p>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
</body>

</html>